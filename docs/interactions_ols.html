<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.0/sandstone/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/solarized-light.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-grid.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-theme-balham.min.css" rel="stylesheet" type="text/css">
        <link href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" rel="stylesheet" type="text/css">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    </head>
    <body>
        <p id="loading">Loading ...</p>
        <div id="app"></div>
    </body>
    <script id="state" type="text">"{:options {:reverse-notes? false, :header? false, :notes-in-cards? false, :initially-collapse? false, :auto-scroll? false, :port 5678, :custom-header [:div {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} \"(notespace)\" [:p \"Sun Dec 18 23:13:45 CET 2022\"] nil [:hr]], :custom-footer [:div [:hr] [:hr]]}, :ids [\"1832\" \"1834\" \"1836\" \"1838\" \"1840\" \"1842\" \"1844\" \"1846\" \"1848\" \"1850\" \"1852\" \"1854\" \"1856\" \"1858\" \"1860\" \"1862\" \"1864\" \"1866\" \"1868\" \"1870\" \"1872\" \"1874\" \"1876\" \"1878\" \"1880\" \"1882\" \"1884\" \"1886\" \"1888\" \"1890\" \"1892\" \"1894\"], :id->content {\"1836\" [:div [:p] nil nil [:p/markdown \"This examples how, how to do interactions in linear regression with `scicloj.ml`\"]], \"1874\" [:div [:p] [:div [:p/code {:code \"(def pipe-interaction\\n  (ml/pipeline\\n   (mm/drop-columns [:newspaper])\\n   (mm/add-column :youtube*facebook (fn [ds] (dtf/* (ds :youtube) (ds :facebook))))\\n   (mm/set-inference-target :sales)\\n   {:metamorph/id :model}(mm/model {:model-type :smile.regression/ordinary-least-square})))\", :bg-class \"bg-light\"}]] nil nil], \"1880\" [:div [:p] nil nil [:p/markdown \"and print it and the performance metrices:\"]], \"1856\" [:div [:p] nil nil [:p/markdown \"and print the result:\"]], \"1866\" [:div [:p] nil nil [:p/markdown \"R2\"]], \"1888\" [:div [:p] [:div [:p/code {:code \"(-> evaluations flatten first :test-transform :metric)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"0.910278084211143\\n\"}]], \"1876\" [:div [:p] nil nil [:p/markdown \"Again we evaluate the model,\"]], \"1864\" [:div [:p] [:div [:p/code {:code \"(-> evaluations flatten first :test-transform :metric)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"1.9444172617257074\\n\"}]], \"1868\" [:div [:p] [:div [:p/code {:code \"(-> evaluations flatten first :test-transform :other-metrices first :metric)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"0.8919962073759851\\n\"}]], \"1838\" [:div [:p] nil nil [:p/markdown \"Taking ideas from: \\nhttp://www.sthda.com/english/articles/40-regression-analysis/164-interaction-effect-in-multiple-regression-essentials/#comments-list\"]], \"1884\" [:div [:p] nil nil [:p/markdown \"As the multiplcation of 'youtube * facebook' is as well statistically relevant, it\\nsuggests that there is indeed an interaction between these 2 predictor variables youtube and facebook.\"]], \"1842\" [:div [:p] nil nil [:p/markdown \"First we load the data:\"]], \"1832\" [:div [:p] [:div [:p/code {:code \"(require '[scicloj.ml.core :as ml]\\n         '[scicloj.ml.metamorph :as mm]\\n         '[scicloj.ml.dataset :refer [dataset add-column]]\\n         '[scicloj.ml.dataset :as ds]\\n         '[tech.v3.dataset.math :as std-math]\\n         '[tech.v3.datatype.functional :as dtf]\\n         '[scicloj.metamorph.ml.toydata :as datasets])\", :bg-class \"bg-light\"}]] nil nil], \"1858\" [:div [:p] [:div [:p/code {:code \"^kind/hiccup\\n(text->hiccup\\n (str\\n  (-> evaluations flatten first :fit-ctx :model ml/thaw-model str)))\", :bg-class \"bg-light\"}]] nil (\"Linear Model:\" [:br] \"\" [:br] \"Residuals:\" [:br] \"       Min          1Q      Median          3Q         Max\" [:br] \"  -10.6397     -1.0434      0.3164      1.4446      3.3400\" [:br] \"\" [:br] \"Coefficients:\" [:br] \"                  Estimate Std. Error    t value   Pr(>|t|)\" [:br] \"Intercept           3.5202     0.4340     8.1103     0.0000 ***\" [:br] \"youtube             0.0454     0.0017    26.9969     0.0000 ***\" [:br] \"facebook            0.1894     0.0103    18.3898     0.0000 ***\" [:br] \"---------------------------------------------------------------------\" [:br] \"Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\" [:br] \"\" [:br] \"Residual standard error: 2.0550 on 130 degrees of freedom\" [:br] \"Multiple R-squared: 0.8994,    Adjusted R-squared: 0.8978\" [:br] \"F-statistic: 580.9835 on 3 and 130 DF,  p-value: 1.496e-65\")], \"1878\" [:div [:p] [:div [:p/code {:code \"(def evaluations\\n  (ml/evaluate-pipelines\\n   [pipe-interaction]\\n   (ds/split->seq marketing :holdout)\\n   ml/rmse\\n   :loss\\n   {:other-metrices [{:name :r2\\n                      :metric-fn fmstats/r2-determination}]}))\", :bg-class \"bg-light\"}]] nil nil], \"1854\" [:div [:p] [:div [:p/code {:code \"(def evaluations\\n  (ml/evaluate-pipelines\\n   [additive-pipeline]\\n   (ds/split->seq marketing :holdout)\\n   ml/rmse\\n   :loss\\n   {:other-metrices [{:name :r2\\n                      :metric-fn fmstats/r2-determination}]}))\", :bg-class \"bg-light\"}]] nil nil], \"1894\" [:div [:p] nil nil [:p/markdown \"RMSE and R2 of the intercation model are sligtly better.\\nThese results suggest that the model with the interaction term is better than the model that contains only main effects.\\nSo, for this specific data, we should go for the model with the interaction model.\\n\"]], \"1840\" [:div [:p] [:div [:p/code {:code \"(defn pp-str [x]\\n  (with-out-str (clojure.pprint/pprint x)))\", :bg-class \"bg-light\"}]] nil nil], \"1886\" [:div [:p] nil nil [:p/markdown \"RMSE\"]], \"1846\" [:div [:p] nil nil [:p/markdown \"## Additive model\"]], \"1848\" [:div [:p] nil nil [:p/markdown \"Firts we build an additive model, which model equation is 'sales = b0 + b1 * youtube + b2 * facebook'\"]], \"1870\" [:div [:p] nil nil [:p/markdown \"## Interaction effects\"]], \"1882\" [:div [:p] [:div [:p/code {:code \"^kind/hiccup\\n(text->hiccup\\n (str\\n  (-> evaluations flatten first :fit-ctx :model ml/thaw-model str)))\", :bg-class \"bg-light\"}]] nil (\"Linear Model:\" [:br] \"\" [:br] \"Residuals:\" [:br] \"       Min          1Q      Median          3Q         Max\" [:br] \"   -7.3251     -0.4438      0.2614      0.7721      1.7986\" [:br] \"\" [:br] \"Coefficients:\" [:br] \"                  Estimate Std. Error    t value   Pr(>|t|)\" [:br] \"Intercept           7.9497     0.3797    20.9361     0.0000 ***\" [:br] \"youtube             0.0201     0.0021     9.5757     0.0000 ***\" [:br] \"facebook            0.0261     0.0112     2.3422     0.0207 *\" [:br] \"youtube*facebook     0.0009     0.0001    15.3438     0.0000 ***\" [:br] \"---------------------------------------------------------------------\" [:br] \"Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\" [:br] \"\" [:br] \"Residual standard error: 1.2414 on 129 degrees of freedom\" [:br] \"Multiple R-squared: 0.9641,    Adjusted R-squared: 0.9632\" [:br] \"F-statistic: 1153.5786 on 4 and 129 DF,  p-value: 6.073e-93\")], \"1852\" [:div [:p] nil nil [:p/markdown \"We evaluate it, \"]], \"1850\" [:div [:p] [:div [:p/code {:code \"(def additive-pipeline\\n  (ml/pipeline\\n   (mm/set-inference-target :sales)\\n   (mm/drop-columns [:newspaper])\\n   {:metamorph/id :model}\\n   (mm/model {:model-type :smile.regression/ordinary-least-square})))\", :bg-class \"bg-light\"}]] nil nil], \"1860\" [:div [:p] nil nil [:p/markdown \"We have the following metrices:\"]], \"1892\" [:div [:p] [:div [:p/code {:code \"(-> evaluations flatten first :test-transform :other-metrices first :metric)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"0.9771083289130588\\n\"}]], \"1844\" [:div [:p] [:div [:p/code {:code \"(def marketing (tc/dataset \\\"data/marketing.csv\\\" {:key-fn keyword}))\", :bg-class \"bg-light\"}]] nil nil], \"1872\" [:div [:p] nil nil [:p/markdown \"Now we add interaction effects to it, resulting in this model equation: 'sales = b0 + b1 * youtube + b2 * facebook + b3 * (youtube * facebook)'\"]], \"1862\" [:div [:p] nil nil [:p/markdown \"RMSE\"]], \"1834\" [:div [:p] [:div [:p/code {:code \"(comment\\n  (note/init-with-browser)\\n  (note/eval-this-notespace)\\n  (note/render-static-html \\\"docs/interactions_ols.html\\\"))\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"nil\\n\"}]], \"1890\" [:div [:p] nil nil [:p/markdown \"R2\"]]}}"</script>
    <script src="gorilla-notes/js/compiled/main.js"></script>
</html>
