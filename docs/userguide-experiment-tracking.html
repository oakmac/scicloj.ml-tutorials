<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.0/sandstone/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/solarized-light.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-grid.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-theme-balham.min.css" rel="stylesheet" type="text/css">
        <link href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" rel="stylesheet" type="text/css">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    </head>
    <body>
        <p id="loading">Loading ...</p>
        <div id="app"></div>
    </body>
    <script id="state" type="text">"{:options {:reverse-notes? false, :header? false, :notes-in-cards? false, :initially-collapse? false, :auto-scroll? false, :port 5678, :custom-header [:div {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} \"(notespace)\" [:p \"Thu Nov 04 22:49:46 CET 2021\"] nil [:hr]], :custom-footer [:div [:hr] [:hr]]}, :ids [\"1975\" \"1977\" \"1979\" \"1981\" \"1983\" \"1985\" \"1987\" \"1989\" \"1991\" \"1993\" \"1995\" \"1997\" \"1999\" \"2001\" \"2003\" \"2005\" \"2007\" \"2009\" \"2011\" \"2013\" \"2015\" \"2017\" \"2019\" \"2021\" \"2023\"], :id->content {\"2001\" [:div [:p] nil nil [:p/markdown \"The function will be called for each evalution result, so in our case 6 times. We use a simple function for now,\\nwhich prints the current declartive pipeline.\"]], \"1983\" [:div [:p] nil nil [:p/markdown \"## Run evaluation\"]], \"1991\" [:div [:p] [:div [:p/code {:code \"(def  evaluation-result\\n  (ml/evaluate-pipelines\\n   pipes split\\n   ml/classification-accuracy\\n   :accuracy\\n   {:result-dissoc-in-seq ml/result-dissoc-in-seq--all\\n    :return-best-crossvalidation-only false\\n    :return-best-pipeline-only false}))\", :bg-class \"bg-light\"}]] nil nil], \"2013\" [:div [:p] [:div [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 20}]]\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 20}]]\\n\"}]], \"1989\" [:div [:p] [:div [:p/code {:code \"(def split (ds/split->seq ds :holdout))\", :bg-class \"bg-light\"}]] nil nil], \"1975\" [:div [:p] [:div [:p/code {:code \"(comment\\n  (note/init-with-browser)\\n  (note/eval-this-notespace)\\n  (note/reread-this-notespace)\\n  (note/render-static-html \\\"docs/userguide-experiment-tracking.html\\\")\\n  (note/init))\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"nil\\n\"}]], \"2015\" [:div [:p] nil nil [:p/markdown \"....\"]], \"1987\" [:div [:p] [:div [:p/code {:code \"(def pipes (map create-base-pipe-decl [1 5 10 20 50 100]))\", :bg-class \"bg-light\"}]] nil nil], \"1985\" [:div [:p] nil nil [:p/markdown \"We create 6 pipelines,  do a simple :holdout split and keep all results. In order to save memory,\\nas we needed to do, if we would have thousands or more evaluations, we keep the minimal information.\"]], \"2011\" [:div [:p] [:div [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 10}]]\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 10}]]\\n\"}]], \"2017\" [:div [:p] nil nil [:p/markdown \"The callback function can now implement whatever needed to store teh evaluation results, for example on disk.\\n\"]], \"2023\" [:div [:p] nil nil [:p/markdown \"This creates one nippy file for each evaluation, containing all data of the evaluations.\"]], \"2021\" [:div [:p] [:div [:p/code {:code \"(def  evaluation-result\\n  (ml/evaluate-pipelines\\n   pipes split\\n   ml/classification-accuracy\\n   :accuracy\\n   {:evaluation-handler-fn\\n    (scicloj.metamorph.ml.evaluation-handler/example-nippy-handler created-files \\\"/tmp\\\" [[:fit-ctx :model :model-data]\\n                                                                                         [:train-transform :ctx :model :model-data]\\n                                                                                         [:test-transform :ctx :model :model-data]])\\n\\n    :attach-fn-sources {:ns (find-ns 'scicloj.ml.experiment-tracking)\\n                        :pipe-fns-clj-file \\\"src/scicloj/ml/experiment_tracking.clj\\\"}}))\", :bg-class \"bg-light\"}]] [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(failed)\"]] nil], \"1997\" [:div [:p] nil nil [:p/markdown \"## Attach a simple result handler\"]], \"1979\" [:div [:p] [:div [:p/code {:code \"(defonce ds (ds/dataset \\\"https://raw.githubusercontent.com/techascent/tech.ml/master/test/data/iris.csv\\\" {:key-fn keyword}))\", :bg-class \"bg-light\"}]] nil nil], \"1977\" [:div [:p] [:div [:p/code {:code \"(require '[scicloj.ml.core :as ml]\\n         '[scicloj.ml.metamorph :as mm]\\n         '[scicloj.ml.dataset  :as ds]\\n         '[scicloj.metamorph.ml.tools :refer [dissoc-in]]\\n         '[taoensso.nippy :as nippy])\", :bg-class \"bg-light\"}]] nil nil], \"1999\" [:div [:p] nil nil [:p/markdown \"A result handler is a function which takes a full map representing a single evalution result and does what ever is needed.\\nIt is by default a function with side effects, and it should return nil.\"]], \"2009\" [:div [:p] [:div [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 5}]]\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 5}]]\\n\"}]], \"2007\" [:div [:p] [:div [:p/code {:code \"^kind/code\\n[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 1}]]\", :bg-class \"bg-light\"}]] nil [:div [:p/code [:tech.v3.dataset.metamorph/set-inference-target [:species]]] [:p/code [:tech.v3.dataset.metamorph/categorical->number [:species]]] [:p/code [:scicloj.metamorph.ml/model {:model-type :smile.classification/random-forest, :node-size 1}]]]], \"1995\" [:div [:p] [:div [:p/code {:code \"(->> evaluation-result flatten\\n     (map (comp :metric :test-transform)))\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"(0.96 0.96 0.96 0.96 0.56 0.26)\\n\"}]], \"2019\" [:div [:p] nil nil [:p/markdown \"Write results to disk\"]], \"2005\" [:div [:p] nil nil [:p/markdown \"repl output: \"]], \"2003\" [:div [:p] [:div [:p/code {:code \"(def  evaluation-result\\n  (ml/evaluate-pipelines\\n   pipes split\\n   ml/classification-accuracy\\n   :accuracy\\n   {:result-dissoc-in-seq ml/result-dissoc-in-seq--all\\n    :return-best-crossvalidation-only false\\n    :return-best-pipeline-only false\\n    :evaluation-handler-fn\\n    (fn [result]\\n      (clojure.pprint/pprint (:pipe-decl result)))}))\", :bg-class \"bg-light\"}]] nil nil], \"1981\" [:div [:p] [:div [:p/code {:code \"(defn create-base-pipe-decl [node-size]\\n  [[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n   [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n   {:metamorph/id :model} [:scicloj.metamorph.ml/model {:model-type :smile.classification/random-forest\\n                                                        :node-size node-size}]])\", :bg-class \"bg-light\"}]] nil nil], \"1993\" [:div [:p] nil nil [:p/markdown \"So we get here 6 evaluation results\"]]}}"</script>
    <script src="gorilla-notes/js/compiled/main.js"></script>
</html>
