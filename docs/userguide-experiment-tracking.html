<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.0/sandstone/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/solarized-light.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-grid.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-theme-balham.min.css" rel="stylesheet" type="text/css">
        <link href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" rel="stylesheet" type="text/css">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    </head>
    <body>
        <p id="loading">Loading ...</p>
        <div id="app"></div>
    </body>
    <script id="state" type="text">"{:options {:reverse-notes? false, :header? false, :notes-in-cards? false, :initially-collapse? false, :auto-scroll? false, :port 1903, :custom-header [:div {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} \"(notespace)\" [:p \"Tue Nov 02 23:11:11 CET 2021\"] nil [:hr]], :custom-footer [:div [:hr] [:hr]]}, :ids [\"118\" \"193\" \"177\" \"178\" \"165\" \"194\" \"195\" \"180\" \"181\" \"182\" \"196\" \"127\" \"197\" \"198\" \"199\" \"186\" \"187\" \"188\" \"200\" \"201\" \"155\" \"156\" \"202\" \"203\" \"204\"], :id->content {\"180\" [:div [:p] [:div [:p/code {:code \"(def split (ds/split->seq ds :holdout))\", :bg-class \"bg-light\"}]] nil nil], \"108\" [:div [:p] [:div [:p/code {:code \"(def results (atom []))\", :bg-class \"bg-light\"}]] nil nil], \"188\" [:div [:p] [:div [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 5}]]\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 5}]]\\n\"}]], \"201\" [:div [:p] [:div [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 20}]]\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 20}]]\\n\"}]], \"139\" [:div [:p] [:div [:p/code {:code \"(comment\\n\\n\\n  (def  evaluation-result\\n    (ml/evaluate-pipelines\\n     pipes split\\n     ml/classification-accuracy\\n     :accuracy\\n     {:result-dissoc-in-seq []\\n      :return-best-crossvalidation-only false\\n      :return-best-pipeline-only false\\n      :attach-fn-sources {:ns (find-ns 'scicloj.ml.experiment-tracking)\\n                          :pipe-fns-clj-file \\\"src/scicloj/ml/experiment_tracking.clj\\\"}}))\\n\\n  (require '[malli.core :as m])\\n  (require '[malli.error :as me])\\n\\n\\n  (->\\n   (meta #'scicloj.metamorph.ml/evaluate-pipelines)\\n   :malli/schema\\n   (nth 2)\\n   (m/explain evaluation-result)\\n   (me/humanize))\\n\\n\\n\\n\\n\\n\\n  :ok)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"nil\\n\"}]], \"155\" [:div [:p] nil nil [:p/markdown \"....\"]], \"202\" [:div [:p] nil nil [:p/markdown \"Write results to disk\"]], \"195\" [:div [:p] [:div [:p/code {:code \"(def pipes (map create-base-pipe-decl [1 5 10 20 50 100]))\", :bg-class \"bg-light\"}]] nil nil], \"118\" [:div [:p] [:div [:p/code {:code \"(comment\\n  (note/init-with-browser)\\n  (note/eval-this-notespace)\\n  (note/reread-this-notespace)\\n  (note/render-static-html \\\"docs/userguide-experiment-tracking.html\\\")\\n  (note/init))\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"nil\\n\"}]], \"193\" [:div [:p] [:div [:p/code {:code \"(require '[scicloj.ml.core :as ml]\\n         '[scicloj.ml.metamorph :as mm]\\n         '[scicloj.ml.dataset  :as ds]\\n         '[scicloj.metamorph.ml.tools :refer [dissoc-in]]\\n         '[taoensso.nippy :as nippy])\", :bg-class \"bg-light\"}]] nil nil], \"105\" [:div [:p] [:div [:p/code {:code \"(->> evaluation-result flatten first :source-information :classpath (take 10))\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"(\\\"test\\\"\\n \\\"src\\\"\\n \\\"resources\\\"\\n \\\"/home/carsten/.m2/repository/aerial/hanami/aerial.hanami/0.12.9/aerial.hanami-0.12.9.jar\\\"\\n \\\"/home/carsten/.gitlibs/libs/applied-science/waqi/faefe5dfd1b161ff70089924591ac2d699527811/resources\\\"\\n \\\"/home/carsten/.gitlibs/libs/applied-science/waqi/faefe5dfd1b161ff70089924591ac2d699527811/src\\\"\\n \\\"/home/carsten/.gitlibs/libs/appliedsciencestudio/rdata/151e6dead06b38995f1f30b09d954a060f7a2a9c/src\\\"\\n \\\"/home/carsten/.gitlibs/libs/appliedsciencestudio/rdata/151e6dead06b38995f1f30b09d954a060f7a2a9c/resources\\\"\\n \\\"/home/carsten/.m2/repository/ch/qos/logback/logback-classic/1.3.0-alpha10/logback-classic-1.3.0-alpha10.jar\\\"\\n \\\"/home/carsten/.m2/repository/cider/cider-nrepl/0.27.2/cider-nrepl-0.27.2.jar\\\")\\n\"}]], \"196\" [:div [:p] [:div [:p/code {:code \"(->> evaluation-result flatten\\n     (map (comp :metric :test-transform)))\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"(0.94 0.94 0.94 0.94 0.44 0.24)\\n\"}]], \"156\" [:div [:p] nil nil [:p/markdown \"The callback function can now implement whatever needed to store teh evaluation results, for example on disk.\\n\"]], \"159\" [:div [:p] [:div [:p/code {:code \"(comment\\n\\n\\n  (def  evaluation-result\\n    (ml/evaluate-pipelines\\n     pipes split\\n     ml/classification-accuracy\\n     :accuracy\\n     {:result-dissoc-in-seq []\\n      :return-best-crossvalidation-only false\\n      :return-best-pipeline-only false\\n      :attach-fn-sources {:ns (find-ns 'scicloj.ml.experiment-tracking)\\n                          :pipe-fns-clj-file \\\"src/scicloj/ml/experiment_tracking.clj\\\"}}))\\n\\n  (require '[malli.core :as m])\\n  (require '[malli.error :as me])\\n\\n\\n  (->\\n   (meta #'scicloj.metamorph.ml/evaluate-pipelines)\\n   :malli/schema\\n   (nth 2)\\n   (m/explain evaluation-result)\\n   (me/humanize))\\n\\n\\n\\n\\n\\n\\n  :ok)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"nil\\n\"}]], \"197\" [:div [:p] nil nil [:p/markdown \"A result handler is a function which takes a full map representing a single evalution result and does what ever is needed.\\nIt is by default a function with side effects, and it should return nil.\"]], \"107\" [:div [:p] [:div [:p/code {:code \"(def created-files (atom []))\", :bg-class \"bg-light\"}]] nil nil], \"111\" [:div [:p] [:div [:p/code {:code \"(comment\\n\\n\\n  (def  evaluation-result\\n    (ml/evaluate-pipelines\\n     pipes split\\n     ml/classification-accuracy\\n     :accuracy\\n     {:result-dissoc-in-seq []\\n      :return-best-crossvalidation-only false\\n      :return-best-pipeline-only false\\n      :attach-fn-sources {:ns (find-ns 'scicloj.ml.experiment-tracking)\\n                          :pipe-fns-clj-file \\\"src/scicloj/ml/experiment_tracking.clj\\\"}}))\\n\\n  (require '[malli.core :as m])\\n  (require '[malli.error :as me])\\n\\n\\n  (->\\n   (meta #'scicloj.metamorph.ml/evaluate-pipelines)\\n   :malli/schema\\n   (nth 2)\\n   (m/explain evaluation-result)\\n   (me/humanize))\\n\\n\\n\\n\\n\\n\\n  :ok)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"nil\\n\"}]], \"203\" [:div [:p] [:div [:p/code {:code \"(def  evaluation-result\\n  (ml/evaluate-pipelines\\n   pipes split\\n   ml/classification-accuracy\\n   :accuracy\\n   {:evaluation-handler-fn\\n    (scicloj.metamorph.ml.evaluation-handler/example-nippy-handler created-files \\\"/tmp\\\" [[:fit-ctx :model :model-data]\\n                                                                                         [:train-transform :ctx :model :model-data]\\n                                                                                         [:test-transform :ctx :model :model-data]])\\n\\n    :attach-fn-sources {:ns (find-ns 'scicloj.ml.experiment-tracking)\\n                        :pipe-fns-clj-file \\\"src/scicloj/ml/experiment_tracking.clj\\\"}}))\", :bg-class \"bg-light\"}]] nil nil], \"199\" [:div [:p] [:div [:p/code {:code \"(def  evaluation-result\\n  (ml/evaluate-pipelines\\n   pipes split\\n   ml/classification-accuracy\\n   :accuracy\\n   {:result-dissoc-in-seq ml/result-dissoc-in-seq--all\\n    :return-best-crossvalidation-only false\\n    :return-best-pipeline-only false\\n    :evaluation-handler-fn\\n    (fn [result]\\n      (clojure.pprint/pprint (:pipe-decl result)))}))\", :bg-class \"bg-light\"}]] nil nil], \"186\" [:div [:p] nil nil [:p/markdown \"repl output: \"]], \"181\" [:div [:p] [:div [:p/code {:code \"(def  evaluation-result\\n  (ml/evaluate-pipelines\\n   pipes split\\n   ml/classification-accuracy\\n   :accuracy\\n   {:result-dissoc-in-seq ml/result-dissoc-in-seq--all\\n    :return-best-crossvalidation-only false\\n    :return-best-pipeline-only false}))\", :bg-class \"bg-light\"}]] nil nil], \"106\" [:div [:p] nil nil [:p/markdown \"Write results to disk\"]], \"194\" [:div [:p] nil nil [:p/markdown \"We create 6 pipelines,  do a simple :holdout split and keep all results. In order to save memory,\\nas we needed to do, if we would have thousands or more evaluations, we keep the minimal information.\"]], \"110\" [:div [:p] [:div [:p/code {:code \"(->\\n (nippy/thaw-from-file (last @created-files))\\n (update-in [:source-information :classpath] #(take 10 %)))\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"{:pipe-decl\\n [[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n  [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n  #:metamorph{:id :model}\\n  [:scicloj.metamorph.ml/model\\n   {:model-type :smile.classification/random-forest, :node-size 100}]],\\n :fit-ctx {:metamorph/mode :fit, :metamorph/data Group: 0 [100 5]:\\n\\n| :sepal_length | :sepal_width | :petal_length | :petal_width | :species |\\n|--------------:|-------------:|--------------:|-------------:|---------:|\\n|           4.5 |          2.3 |           1.3 |          0.3 |      1.0 |\\n|           4.4 |          2.9 |           1.4 |          0.2 |      1.0 |\\n|           5.0 |          3.0 |           1.6 |          0.2 |      1.0 |\\n|           6.9 |          3.1 |           5.4 |          2.1 |      2.0 |\\n|           6.8 |          3.2 |           5.9 |          2.3 |      2.0 |\\n|           6.1 |          2.9 |           4.7 |          1.4 |      0.0 |\\n|           5.4 |          3.4 |           1.5 |          0.4 |      1.0 |\\n|           5.7 |          2.9 |           4.2 |          1.3 |      0.0 |\\n|           7.2 |          3.6 |           6.1 |          2.5 |      2.0 |\\n|           5.8 |          2.7 |           5.1 |          1.9 |      2.0 |\\n|           5.9 |          3.0 |           4.2 |          1.5 |      0.0 |\\n|           5.1 |          3.8 |           1.5 |          0.3 |      1.0 |\\n|           6.4 |          2.8 |           5.6 |          2.1 |      2.0 |\\n|           5.1 |          3.8 |           1.6 |          0.2 |      1.0 |\\n|           7.7 |          3.8 |           6.7 |          2.2 |      2.0 |\\n|           6.5 |          3.2 |           5.1 |          2.0 |      2.0 |\\n|           5.6 |          2.5 |           3.9 |          1.1 |      0.0 |\\n|           6.4 |          2.8 |           5.6 |          2.2 |      2.0 |\\n|           6.7 |          3.1 |           4.4 |          1.4 |      0.0 |\\n|           5.5 |          2.3 |           4.0 |          1.3 |      0.0 |\\n|           4.9 |          2.4 |           3.3 |          1.0 |      0.0 |\\n|           7.1 |          3.0 |           5.9 |          2.1 |      2.0 |\\n|           5.6 |          2.9 |           3.6 |          1.3 |      0.0 |\\n|           7.9 |          3.8 |           6.4 |          2.0 |      2.0 |\\n|           5.6 |          2.8 |           4.9 |          2.0 |      2.0 |\\n,\\n           :model\\n           {:options\\n            {:model-type :smile.classification/random-forest,\\n             :node-size 100},\\n            :id #uuid \\\"a3fa01e4-bd37-49a3-835c-53762405e33a\\\",\\n            :feature-columns\\n            [:sepal_length :sepal_width :petal_length :petal_width],\\n            :target-columns [:species],\\n            :target-categorical-maps\\n            {:species\\n             {:lookup-table\\n              {\\\"versicolor\\\" 0, \\\"setosa\\\" 1, \\\"virginica\\\" 2},\\n              :src-column :species,\\n              :result-datatype :float64}},\\n            :scicloj.metamorph.ml/unsupervised? nil}},\\n :timing-fit 5,\\n :source-information\\n {:fn-sources\\n  {scicloj.metamorph.ml/model\\n   {:source-str\\n    \\\"(defn model\\\\n  \\\\\\\"Executes a machine learning model in train/predict (depending on :mode)\\\\n  from the `metamorph.ml` model registry.\\\\n\\\\n  The model is passed between both invocation via the shared context ctx in a\\\\n  key (a step indentifier) which is passed in key `:metamorph/id` and guarantied to be unique for each\\\\n  pipeline step.\\\\n\\\\n  The function writes and reads into this common context key.\\\\n\\\\n  Options:\\\\n  - `:model-type` - Keyword for the model to use\\\\n\\\\n  Further options get passed to `train` functions and are model specific.\\\\n\\\\n  See here for an overview for the models build into scicloj.ml:\\\\n\\\\n\\\\n  https://scicloj.github.io/scicloj.ml-tutorials/userguide-models.html\\\\n\\\\n  Other libraries might contribute other models,\\\\n  which are documented as part of the library.\\\\n\\\\n\\\\n  metamorph                            | .\\\\n  -------------------------------------|----------------------------------------------------------------------------\\\\n  Behaviour in mode :fit               | Calls `scicloj.metamorph.ml/train` using data in `:metamorph/data` and `options`and stores trained model in ctx under key in `:metamorph/id`\\\\n  Behaviour in mode :transform         | Reads trained model from ctx and calls `scicloj.metamorph.ml/predict` with the model in $id and data in `:metamorph/data`\\\\n  Reads keys from ctx                  | In mode `:transform` : Reads trained model to use for prediction from key in `:metamorph/id`.\\\\n  Writes keys to ctx                   | In mode `:fit` : Stores trained model in key $id and writes feature-ds and target-ds before prediction into ctx at `:scicloj.metamorph.ml/feature-ds` /`:scicloj.metamorph.ml/target-ds`\\\\n\\\\n\\\\n\\\\n\\\\n  See as well:\\\\n\\\\n  * `scicloj.metamorph.ml/train`\\\\n  * `scicloj.metamorph.ml/predict`\\\\n\\\\n  \\\\\\\"\\\\n  {:malli/schema [:=> [:cat map?] [map?]]}\\\\n  [options]\\\\n\\\\n  (malli/instrument-mm\\\\n   (fn [{:metamorph/keys [id data mode] :as ctx}]\\\\n\\\\n     (case mode\\\\n       :fit (assoc ctx\\\\n                   id (assoc (train data options)\\\\n                             ::unsupervised? (get (options->model-def options) :unsupervised? false)))\\\\n\\\\n       :transform  (do\\\\n                     (if (get-in ctx [id ::unsupervised?])\\\\n                       ctx\\\\n                       (-> ctx\\\\n                           (update\\\\n                                   id\\\\n                                   assoc\\\\n                                   ::feature-ds (cf/feature data)\\\\n                                   ::target-ds (cf/target data))\\\\n                           (assoc\\\\n                            :metamorph/data (predict data (get ctx id))))))))))\\\",\\n    :source-form\\n    (defn\\n     model\\n     \\\"Executes a machine learning model in train/predict (depending on :mode)\\\\n  from the `metamorph.ml` model registry.\\\\n\\\\n  The model is passed between both invocation via the shared context ctx in a\\\\n  key (a step indentifier) which is passed in key `:metamorph/id` and guarantied to be unique for each\\\\n  pipeline step.\\\\n\\\\n  The function writes and reads into this common context key.\\\\n\\\\n  Options:\\\\n  - `:model-type` - Keyword for the model to use\\\\n\\\\n  Further options get passed to `train` functions and are model specific.\\\\n\\\\n  See here for an overview for the models build into scicloj.ml:\\\\n\\\\n\\\\n  https://scicloj.github.io/scicloj.ml-tutorials/userguide-models.html\\\\n\\\\n  Other libraries might contribute other models,\\\\n  which are documented as part of the library.\\\\n\\\\n\\\\n  metamorph                            | .\\\\n  -------------------------------------|----------------------------------------------------------------------------\\\\n  Behaviour in mode :fit               | Calls `scicloj.metamorph.ml/train` using data in `:metamorph/data` and `options`and stores trained model in ctx under key in `:metamorph/id`\\\\n  Behaviour in mode :transform         | Reads trained model from ctx and calls `scicloj.metamorph.ml/predict` with the model in $id and data in `:metamorph/data`\\\\n  Reads keys from ctx                  | In mode `:transform` : Reads trained model to use for prediction from key in `:metamorph/id`.\\\\n  Writes keys to ctx                   | In mode `:fit` : Stores trained model in key $id and writes feature-ds and target-ds before prediction into ctx at `:scicloj.metamorph.ml/feature-ds` /`:scicloj.metamorph.ml/target-ds`\\\\n\\\\n\\\\n\\\\n\\\\n  See as well:\\\\n\\\\n  * `scicloj.metamorph.ml/train`\\\\n  * `scicloj.metamorph.ml/predict`\\\\n\\\\n  \\\"\\n     #:malli{:schema [:=> [:cat map?] [map?]]}\\n     [options]\\n     (malli/instrument-mm\\n      (fn\\n       [{:metamorph/keys [id data mode], :as ctx}]\\n       (case\\n        mode\\n        :fit\\n        (assoc\\n         ctx\\n         id\\n         (assoc\\n          (train data options)\\n          :scicloj.ml.experiment-tracking/unsupervised?\\n          (get (options->model-def options) :unsupervised? false)))\\n        :transform\\n        (do\\n         (if\\n          (get-in\\n           ctx\\n           [id :scicloj.ml.experiment-tracking/unsupervised?])\\n          ctx\\n          (->\\n           ctx\\n           (update\\n            id\\n            assoc\\n            :scicloj.ml.experiment-tracking/feature-ds\\n            (cf/feature data)\\n            :scicloj.ml.experiment-tracking/target-ds\\n            (cf/target data))\\n           (assoc :metamorph/data (predict data (get ctx id))))))))))},\\n   tech.v3.dataset.metamorph/set-inference-target\\n   {:source-str\\n    \\\"(defn set-inference-target\\\\n  \\\\\\\"Set the inference target on the column.  This sets the :column-type member\\\\n  of the column metadata to :inference-target?.\\\\\\\"\\\\n  [dataset target-name-or-target-name-seq]\\\\n  (let [colnames (if (sequential? target-name-or-target-name-seq)\\\\n                   target-name-or-target-name-seq\\\\n                   [target-name-or-target-name-seq])]\\\\n    (ds-base/update-columns dataset colnames\\\\n                            #(vary-meta % assoc :inference-target? true))))\\\",\\n    :source-form\\n    (defn\\n     set-inference-target\\n     \\\"Set the inference target on the column.  This sets the :column-type member\\\\n  of the column metadata to :inference-target?.\\\"\\n     [dataset target-name-or-target-name-seq]\\n     (let\\n      [colnames\\n       (if\\n        (sequential? target-name-or-target-name-seq)\\n        target-name-or-target-name-seq\\n        [target-name-or-target-name-seq])]\\n      (ds-base/update-columns\\n       dataset\\n       colnames\\n       (fn*\\n        [p1__82158#]\\n        (vary-meta p1__82158# assoc :inference-target? true)))))},\\n   tech.v3.dataset.metamorph/categorical->number\\n   {:source-str\\n    \\\"(defn categorical->number\\\\n  \\\\\\\"Convert columns into a discrete , numeric representation\\\\n  See tech.v3.dataset.categorical/fit-categorical-map.\\\\\\\"\\\\n  ([dataset filter-fn-or-ds]\\\\n   (categorical->number dataset filter-fn-or-ds nil nil))\\\\n  ([dataset filter-fn-or-ds table-args]\\\\n   (categorical->number dataset filter-fn-or-ds table-args nil))\\\\n  ([dataset filter-fn-or-ds table-args result-datatype]\\\\n   (update dataset filter-fn-or-ds\\\\n           (fn [filtered-ds]\\\\n             (reduce\\\\n              (fn [filtered-ds colname]\\\\n                (let [fit-data\\\\n                      (ds-cat/fit-categorical-map\\\\n                       filtered-ds colname table-args result-datatype)]\\\\n                  (ds-cat/transform-categorical-map filtered-ds fit-data)))\\\\n              filtered-ds\\\\n              (column-names filtered-ds))))))\\\",\\n    :source-form\\n    (defn\\n     categorical->number\\n     \\\"Convert columns into a discrete , numeric representation\\\\n  See tech.v3.dataset.categorical/fit-categorical-map.\\\"\\n     ([dataset filter-fn-or-ds]\\n      (categorical->number dataset filter-fn-or-ds nil nil))\\n     ([dataset filter-fn-or-ds table-args]\\n      (categorical->number dataset filter-fn-or-ds table-args nil))\\n     ([dataset filter-fn-or-ds table-args result-datatype]\\n      (update\\n       dataset\\n       filter-fn-or-ds\\n       (fn\\n        [filtered-ds]\\n        (reduce\\n         (fn\\n          [filtered-ds colname]\\n          (let\\n           [fit-data\\n            (ds-cat/fit-categorical-map\\n             filtered-ds\\n             colname\\n             table-args\\n             result-datatype)]\\n           (ds-cat/transform-categorical-map filtered-ds fit-data)))\\n         filtered-ds\\n         (column-names filtered-ds))))))}},\\n  :classpath\\n  (\\\"test\\\"\\n   \\\"src\\\"\\n   \\\"resources\\\"\\n   \\\"/home/carsten/.m2/repository/aerial/hanami/aerial.hanami/0.12.9/aerial.hanami-0.12.9.jar\\\"\\n   \\\"/home/carsten/.gitlibs/libs/applied-science/waqi/faefe5dfd1b161ff70089924591ac2d699527811/resources\\\"\\n   \\\"/home/carsten/.gitlibs/libs/applied-science/waqi/faefe5dfd1b161ff70089924591ac2d699527811/src\\\"\\n   \\\"/home/carsten/.gitlibs/libs/appliedsciencestudio/rdata/151e6dead06b38995f1f30b09d954a060f7a2a9c/src\\\"\\n   \\\"/home/carsten/.gitlibs/libs/appliedsciencestudio/rdata/151e6dead06b38995f1f30b09d954a060f7a2a9c/resources\\\"\\n   \\\"/home/carsten/.m2/repository/ch/qos/logback/logback-classic/1.3.0-alpha10/logback-classic-1.3.0-alpha10.jar\\\"\\n   \\\"/home/carsten/.m2/repository/cider/cider-nrepl/0.27.2/cider-nrepl-0.27.2.jar\\\")},\\n :train-transform\\n {:other-metrices (),\\n  :timing 3,\\n  :ctx {:metamorph/mode :transform, :metamorph/data :_unnamed [100 4]:\\n\\n| versicolor |     setosa |  virginica | :species |\\n|-----------:|-----------:|-----------:|---------:|\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n,\\n        :model\\n        {:feature-columns\\n         [:sepal_length :sepal_width :petal_length :petal_width],\\n         :target-categorical-maps\\n         {:species\\n          {:lookup-table {\\\"versicolor\\\" 0, \\\"setosa\\\" 1, \\\"virginica\\\" 2},\\n           :src-column :species,\\n           :result-datatype :float64}},\\n         :target-columns [:species],\\n         :scicloj.metamorph.ml/unsupervised? nil,\\n         :scicloj.metamorph.ml/feature-ds Group: 0 [100 4]:\\n\\n| :sepal_length | :sepal_width | :petal_length | :petal_width |\\n|--------------:|-------------:|--------------:|-------------:|\\n|           4.5 |          2.3 |           1.3 |          0.3 |\\n|           4.4 |          2.9 |           1.4 |          0.2 |\\n|           5.0 |          3.0 |           1.6 |          0.2 |\\n|           6.9 |          3.1 |           5.4 |          2.1 |\\n|           6.8 |          3.2 |           5.9 |          2.3 |\\n|           6.1 |          2.9 |           4.7 |          1.4 |\\n|           5.4 |          3.4 |           1.5 |          0.4 |\\n|           5.7 |          2.9 |           4.2 |          1.3 |\\n|           7.2 |          3.6 |           6.1 |          2.5 |\\n|           5.8 |          2.7 |           5.1 |          1.9 |\\n|           5.9 |          3.0 |           4.2 |          1.5 |\\n|           5.1 |          3.8 |           1.5 |          0.3 |\\n|           6.4 |          2.8 |           5.6 |          2.1 |\\n|           5.1 |          3.8 |           1.6 |          0.2 |\\n|           7.7 |          3.8 |           6.7 |          2.2 |\\n|           6.5 |          3.2 |           5.1 |          2.0 |\\n|           5.6 |          2.5 |           3.9 |          1.1 |\\n|           6.4 |          2.8 |           5.6 |          2.2 |\\n|           6.7 |          3.1 |           4.4 |          1.4 |\\n|           5.5 |          2.3 |           4.0 |          1.3 |\\n|           4.9 |          2.4 |           3.3 |          1.0 |\\n|           7.1 |          3.0 |           5.9 |          2.1 |\\n|           5.6 |          2.9 |           3.6 |          1.3 |\\n|           7.9 |          3.8 |           6.4 |          2.0 |\\n|           5.6 |          2.8 |           4.9 |          2.0 |\\n,\\n         :id #uuid \\\"a3fa01e4-bd37-49a3-835c-53762405e33a\\\",\\n         :scicloj.metamorph.ml/target-ds Group: 0 [100 1]:\\n\\n| :species |\\n|---------:|\\n|      1.0 |\\n|      1.0 |\\n|      1.0 |\\n|      2.0 |\\n|      2.0 |\\n|      0.0 |\\n|      1.0 |\\n|      0.0 |\\n|      2.0 |\\n|      2.0 |\\n|      0.0 |\\n|      1.0 |\\n|      2.0 |\\n|      1.0 |\\n|      2.0 |\\n|      2.0 |\\n|      0.0 |\\n|      2.0 |\\n|      0.0 |\\n|      0.0 |\\n|      0.0 |\\n|      2.0 |\\n|      0.0 |\\n|      2.0 |\\n|      2.0 |\\n,\\n         :options\\n         {:model-type :smile.classification/random-forest,\\n          :node-size 100}}},\\n  :metric 0.34},\\n :test-transform\\n {:other-metrices (),\\n  :timing 2,\\n  :ctx {:metamorph/mode :transform, :metamorph/data :_unnamed [50 4]:\\n\\n| versicolor |     setosa |  virginica | :species |\\n|-----------:|-----------:|-----------:|---------:|\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n| 0.32038835 | 0.33980583 | 0.33980583 |      1.0 |\\n,\\n        :model\\n        {:feature-columns\\n         [:sepal_length :sepal_width :petal_length :petal_width],\\n         :target-categorical-maps\\n         {:species\\n          {:lookup-table {\\\"versicolor\\\" 0, \\\"setosa\\\" 1, \\\"virginica\\\" 2},\\n           :src-column :species,\\n           :result-datatype :float64}},\\n         :target-columns [:species],\\n         :scicloj.metamorph.ml/unsupervised? nil,\\n         :scicloj.metamorph.ml/feature-ds Group: 0 [50 4]:\\n\\n| :sepal_length | :sepal_width | :petal_length | :petal_width |\\n|--------------:|-------------:|--------------:|-------------:|\\n|           6.8 |          2.8 |           4.8 |          1.4 |\\n|           5.4 |          3.9 |           1.7 |          0.4 |\\n|           6.4 |          3.2 |           4.5 |          1.5 |\\n|           5.0 |          3.4 |           1.6 |          0.4 |\\n|           5.7 |          2.8 |           4.1 |          1.3 |\\n|           5.8 |          2.7 |           5.1 |          1.9 |\\n|           7.2 |          3.0 |           5.8 |          1.6 |\\n|           4.6 |          3.6 |           1.0 |          0.2 |\\n|           5.8 |          2.7 |           3.9 |          1.2 |\\n|           6.7 |          3.3 |           5.7 |          2.1 |\\n|           4.9 |          2.5 |           4.5 |          1.7 |\\n|           6.0 |          3.0 |           4.8 |          1.8 |\\n|           6.1 |          3.0 |           4.9 |          1.8 |\\n|           5.8 |          2.6 |           4.0 |          1.2 |\\n|           5.4 |          3.0 |           4.5 |          1.5 |\\n|           7.4 |          2.8 |           6.1 |          1.9 |\\n|           7.7 |          2.6 |           6.9 |          2.3 |\\n|           5.6 |          3.0 |           4.1 |          1.3 |\\n|           6.5 |          3.0 |           5.5 |          1.8 |\\n|           5.0 |          3.5 |           1.6 |          0.6 |\\n|           5.0 |          3.2 |           1.2 |          0.2 |\\n|           5.1 |          3.4 |           1.5 |          0.2 |\\n|           6.3 |          2.3 |           4.4 |          1.3 |\\n|           5.8 |          4.0 |           1.2 |          0.2 |\\n|           4.6 |          3.2 |           1.4 |          0.2 |\\n,\\n         :id #uuid \\\"a3fa01e4-bd37-49a3-835c-53762405e33a\\\",\\n         :scicloj.metamorph.ml/target-ds Group: 0 [50 1]:\\n\\n| :species |\\n|---------:|\\n|      0.0 |\\n|      1.0 |\\n|      0.0 |\\n|      1.0 |\\n|      0.0 |\\n|      2.0 |\\n|      2.0 |\\n|      1.0 |\\n|      0.0 |\\n|      2.0 |\\n|      2.0 |\\n|      2.0 |\\n|      2.0 |\\n|      0.0 |\\n|      0.0 |\\n|      2.0 |\\n|      2.0 |\\n|      0.0 |\\n|      2.0 |\\n|      1.0 |\\n|      1.0 |\\n|      1.0 |\\n|      0.0 |\\n|      1.0 |\\n|      1.0 |\\n,\\n         :options\\n         {:model-type :smile.classification/random-forest,\\n          :node-size 100}}},\\n  :metric 0.32},\\n :loss-or-accuracy :accuracy}\\n\"}]], \"174\" [:div [:p] [:div [:p/code {:code \"(comment\\n\\n\\n  (def  evaluation-result\\n    (ml/evaluate-pipelines\\n     pipes split\\n     ml/classification-accuracy\\n     :accuracy\\n     {:result-dissoc-in-seq []\\n      :return-best-crossvalidation-only false\\n      :return-best-pipeline-only false\\n      :attach-fn-sources {:ns (find-ns 'scicloj.ml.experiment-tracking)\\n                          :pipe-fns-clj-file \\\"src/scicloj/ml/experiment_tracking.clj\\\"}}))\\n\\n  (require '[malli.core :as m])\\n  (require '[malli.error :as me])\\n\\n\\n  (->\\n   (meta #'scicloj.metamorph.ml/evaluate-pipelines)\\n   :malli/schema\\n   (nth 2)\\n   (m/explain evaluation-result)\\n   (me/humanize))\\n\\n\\n\\n\\n\\n\\n  :ok)\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"nil\\n\"}]], \"200\" [:div [:p] [:div [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 10}]]\", :bg-class \"bg-light\"}]] nil [:p/code {:code \"[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 10}]]\\n\"}]], \"177\" [:div [:p] [:div [:p/code {:code \"(defonce ds (ds/dataset \\\"https://raw.githubusercontent.com/techascent/tech.ml/master/test/data/iris.csv\\\" {:key-fn keyword}))\", :bg-class \"bg-light\"}]] nil nil], \"165\" [:div [:p] nil nil [:p/markdown \"## Run evaluation\"]], \"127\" [:div [:p] nil nil [:p/markdown \"## Attach a simple result handler\"]], \"109\" [:div [:p] [:div [:p/code {:code \"(def  evaluation-result\\n  (ml/evaluate-pipelines\\n   pipes split\\n   ml/classification-accuracy\\n   :accuracy\\n   {:evaluation-handler-fn\\n     ;; (fn [result] (swap! results #(conj % result)))\\n    (scicloj.metamorph.ml.evaluation-handler/example-nippy-handler created-files \\\"/tmp\\\" [[:fit-ctx :model :model-data]\\n                                                                                         [:train-transform :ctx :model :model-data]\\n                                                                                         [:test-transform :ctx :model :model-data]])\\n\\n    :attach-fn-sources {:ns (find-ns 'scicloj.ml.experiment-tracking)\\n                        :pipe-fns-clj-file \\\"src/scicloj/ml/experiment_tracking.clj\\\"}}))\", :bg-class \"bg-light\"}]] nil nil], \"198\" [:div [:p] nil nil [:p/markdown \"The function will be called for each evalution result, so in our case 6 times. We use a simple function for now,\\nwhich prints the current declartive pipeline.\"]], \"182\" [:div [:p] nil nil [:p/markdown \"So we get here 6 evaluation results\"]], \"204\" [:div [:p] nil nil [:p/markdown \"This creates one nippy file for each evaluation, containing all data of the evaluations.\"]], \"178\" [:div [:p] [:div [:p/code {:code \"(defn create-base-pipe-decl [node-size]\\n  [[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n   [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n   {:metamorph/id :model} [:scicloj.metamorph.ml/model {:model-type :smile.classification/random-forest\\n                                                        :node-size node-size}]])\", :bg-class \"bg-light\"}]] nil nil], \"187\" [:div [:p] [:div [:p/code {:code \"^kind/code\\n[[:tech.v3.dataset.metamorph/set-inference-target [:species]]\\n [:tech.v3.dataset.metamorph/categorical->number [:species]]\\n [:scicloj.metamorph.ml/model\\n  {:model-type :smile.classification/random-forest, :node-size 1}]]\", :bg-class \"bg-light\"}]] nil [:div [:p/code [:tech.v3.dataset.metamorph/set-inference-target [:species]]] [:p/code [:tech.v3.dataset.metamorph/categorical->number [:species]]] [:p/code [:scicloj.metamorph.ml/model {:model-type :smile.classification/random-forest, :node-size 1}]]]]}}"</script>
    <script src="gorilla-notes/js/compiled/main.js"></script>
</html>
